-- Duplicate encounter check 

SELECT member_id, provider_id, service_date, COUNT(*) AS dup_cnt
FROM target_encounters
GROUP BY member_id, provider_id, service_date
HAVING COUNT(*) > 1;

-- Missing diagnosis/procedure codes

SELECT *
FROM target_encounters
WHERE (icd_code IS NULL OR icd_code = '')
   OR (cpt_code IS NULL OR cpt_code = '');

